This code has few changes that will go into second set of changes.
